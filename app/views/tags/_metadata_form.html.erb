<!-- Primary Author: Jonathan Allen (jallen01) -->

<!-- Days -->
<%= content_tag :div, class: "panel-group", id: "metadata-accordion-#{tag.id}" do %>
  
  <div class="panel panel-default">
    <%= content_tag :div, "Days", data: { toggle: "collapse", target: "#day-ranges-collapse-#{tag.id}", parent: "#metadata-accordion-#{tag.id}" }, class: "panel-heading" %>
    <%= content_tag :div, id: "day-ranges-collapse-#{tag.id}", class: "panel-collapse collapse in" do %>
      <div class="panel-body">
        <div class="btn-group day-ranges" data-toggle="buttons">
          <!-- Predefined day ranges -->
          <% current_user.get_day_ranges.each do |day_range| %>
            <%= content_tag :label, class: "btn btn-default btn-buffer day-button-bar spec-tag #{(tag.day_ranges.include?(day_range) ? 'active' : '')}" do %>
              <%= check_box_tag "day_ranges[]", day_range.id, tag.day_ranges.include?(day_range) %>
              <%= day_range.name %>
            <% end %> 
          <% end %>
          <%= content_tag :label, class: "btn btn-default btn-buffer custom-day-range spec-tag #{"active" if !tag.hidden_day_range.empty?}".html_safe do %>
            <%= check_box_tag "custom-d-range", "custom" %>
            Custom
          <% end %> 
        </div>

        <br>

        <!-- Day range input -->
        <div class="day-ranges-custom">
          <%= render "day_ranges/select", day_range: tag.hidden_day_range %>
        </div>
      </div>
    <% end %>
  </div>

  <div class="panel panel-default">
    <%= content_tag :div, "Times", data: { toggle: "collapse", target: "#time-ranges-collapse-#{tag.id}", parent: "#metadata-accordion-#{tag.id}" }, class: "panel-heading" %>
    <%= content_tag :div, id: "time-ranges-collapse-#{tag.id}", class: "panel-collapse collapse" do %>
      <div class="panel-body">
        <div class="btn-group time-ranges" data-toggle="buttons">
          <!-- Predefined time ranges -->
          <% current_user.get_time_ranges.each do |time_range| %>
            <%= content_tag :label, class: "btn btn-default btn-buffer time-button-bar spec-tag #{(tag.time_ranges.include?(time_range) ? 'active' : '')}" do %>
              <%= check_box_tag "time_ranges[]", time_range.id, tag.time_ranges.include?(time_range) %>
              <%= time_range.name %>
            <% end %> 
          <% end %>
          <%= content_tag :label, class: "btn btn-default btn-buffer custom-time-range spec-tag #{"active" if !tag.hidden_time_range.empty?}".html_safe do %>
            <%= check_box_tag "custom-t-range", "custom" %>
            Custom
          <% end %> 
        </div>

        <br>

        <!-- Time range input -->
        <div class="time-ranges-custom">
          <%= render "time_ranges/select", time_range: tag.hidden_time_range %>
        </div>
      </div>
    <% end %>
  </div>

  <div class="panel panel-default">
    <%= content_tag :div, "Locations", data: { toggle: "collapse", target: "#locations-collapse-#{tag.id}", parent: "#metadata-accordion-#{tag.id}" }, class: "panel-heading" %>
    <%= content_tag :div, id: "locations-collapse-#{tag.id}", class: "panel-collapse collapse" do %>
      <div class="panel-body">
        <div class="btn-group locations" data-toggle="buttons">
          <% current_user.get_locations.each do |location| %>
            <%= content_tag :label, class: "btn btn-default btn-buffer location-button-bar spec-tag #{(tag.locations.include?(location) ? 'active' : '')}" do %>
              <%= check_box_tag "locations[]", location.id, tag.locations.include?(location) %>
              <%= location.name %>
            <% end %>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

<% end %>
