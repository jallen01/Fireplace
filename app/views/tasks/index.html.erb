<!-- Primary Author: Jonathan Allen (jallen01) -->

<div class="row">
  <div class="col-md-4 page-header">
    <h1><%= current_user.first_name %>'s Fireplace</h1>
    <div data-toggle="modal" data-target="#context-overrides-modal" id="context-overrides">
      <h4>

        <%=content_tag :span, "Time Frame: #{(session[:overrides][:time_frame] || "Automatic").capitalize}", class: "label label-info", id: "time-label" %>

      </h4>
      <h4>
        <%= content_tag :span, "Location: #{(session[:overrides][:location] || "Automatic").capitalize}", class: "label label-info", id: "location-label", data: { :"update-url" => update_location_user_url(current_user).html_safe } %>
      </h4>
      <h5 class="text-info">Change Context</h5>
    </div>
  </div>
</div>

<!-- Filter policies -->
<div class="btn-toolbar">
  <!-- Toggle buttons -->
  <div class="btn-group">
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#new-task-modal">New Task</button>
  </div>

  <div class="btn-group" data-toggle="buttons">
    <label class="btn btn-default">
      <input type="checkbox" data-filter="all" class="filter-policy-toggle">All Tasks
    </label>
    <label class="btn btn-default">
      <input type="checkbox" data-filter="quick" class="filter-policy-toggle">Only Quick Tasks
    </label>
    <label class="btn btn-default">
      <input type="checkbox" data-filter="important" class="filter-policy-toggle">Only Important Tasks
    </label>
  </div>
</div>

<hr>

<div class="row">
  <div id="tasks-list" class="col-md-8">
    <%= render "tasks/list" %>
  </div>
</div>

<!-- New task modal -->
<%= render "layouts/modal_form", object: @new_task, modal_id: "new-task-modal", modal_title: "New Task", modal_data: { form: "reset" }, modal_content: render("tasks/form", task: @new_task) %>

<!-- User context overrides modal -->
<%= render "layouts/modal_display", modal_id: "context-overrides-modal", modal_title: "User Context Overrides", modal_data: { form: "reset" }, modal_content: render("users/context_overrides_form") %>
